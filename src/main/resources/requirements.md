# SSAFYHome 요구사항 명세서

## 📋 목차

1. [프로젝트 개요](#프로젝트-개요)
2. [기능별 요구사항](#기능별-요구사항)
3. [우선순위 요약](#우선순위-요약)
4. [비기능 요구사항](#비기능-요구사항)

---

## 📌 프로젝트 개요

### 프로젝트 목적

2030세대를 위한 **현실적인 내집마련 지원 플랫폼**으로, 단순 정보 제공을 넘어 구체적인 행동 유도와 지속적인 동기 부여를 제공합니다.

### 핵심 컨셉: Grome (Grow My Home)

저축 활동을 **'집 키우기'**로 게이미피케이션하여, 지루한 저축 과정을 즐거운 경험으로 전환합니다.

### 차별점

1. **2025년 스트레스 DSR 3단계 규제 완전 반영** - 현실적 대출 한도 계산
2. **구매력 기반 맞춤 매물 추천** - 모든 매물이 아닌, 살 수 있는 매물만
3. **저축과 연동된 게이미피케이션 시스템** - 지속적 동기 부여

### 대상 사용자

- **주 타겟**: 20대 후반 ~ 30대 초반 직장인
- **연소득**: 3,000만원 ~ 6,000만원
- **목표**: 수도권 중소형 아파트 구매 (3억 ~ 5억)

---

## 🎯 기능별 요구사항

### 우선순위 표기

- `[P0]` MUST - MVP 핵심 기능
- `[P1]` SHOULD - 서비스 차별화 기능
- `[P2]` COULD - 향후 확장 기능

---

## 1. 회원 관리

### [P0] REQ-1.1 회원가입 및 로그인

**설명**: 이메일/비밀번호 기반 회원가입 및 JWT 인증 로그인
**관련 테이블**: `users`

**입력**:

- 이메일, 비밀번호, 이름, 출생연도

**출력**:

- JWT 토큰 (Access Token + Refresh Token)
- 사용자 기본 정보

**제약조건**:

- 이메일 중복 불가
- 비밀번호 bcrypt 해싱
- Access Token 1시간, Refresh Token 14일

---

### [P0] REQ-1.2 온보딩 프로세스

**설명**: 신규 가입자의 연소득, 기존 대출, 희망 지역 입력
**관련 테이블**: `users`, `preferred_areas`

**입력**:

- Step 1: 출생연도
- Step 2: 연소득 (슬라이더, 2,000만원 ~ 1억원)
- Step 3: 기존 대출 월 상환액
- Step 4: 희망 지역 (시/도, 구/군, 최대 3개)

**출력**:

- `onboarding_completed=TRUE` 업데이트
- `region_preference_metro` 자동 계산 (수도권 여부)
- 즉시 '나의 구매력 분석' 화면 이동

**제약조건**:

- 온보딩 미완료 시 일부 기능 제한
- `preferred_areas`에 최대 3개 지역 등록

---

### [P1] REQ-1.3 프로필 수정

**설명**: 연소득, 기존 대출, 희망 지역 수정 기능
**관련 테이블**: `users`, `preferred_areas`

**입력**:

- 연소득, 기존 대출 월 상환액
- 희망 지역 추가/삭제

**출력**:

- 수정 성공 메시지
- 변경된 정보 기반 DSR 재계산 안내

**제약조건**:

- 7일 내 연소득 3회 이상 변경 시 이상거래 감지 (FDS)

---

### [P1] REQ-1.4 소셜 로그인

**설명**: 카카오, Google OAuth 로그인
**관련 테이블**: `users`

**입력**:

- 소셜 로그인 제공자 선택

**출력**:

- JWT 토큰 발급
- `social_provider`, `social_id` 저장

**제약조건**:

- 이메일 중복 시 기존 계정 연동

---

## 2. 매물 조회

### [P0] REQ-2.1 구매력 기반 매물 필터링

**설명**: 사용자의 DSR 계산 결과 기반으로 실제 구매 가능한 매물만 표시
**관련 테이블**: `properties`, `users`, `preferred_areas`, `dsr_calculations`

**입력**:

- 사용자 연소득, 기존 대출 월 상환액
- 희망 지역 (preferred_areas)

**출력**:

- 필터링된 매물 리스트
- 각 매물의 "구매력 대비 퍼센트" 표시
- 필요 계약금 (매물가 × 30%)

**제약조건**:

- 최대 대출 가능액 = DSR 계산 결과
- 필요 자기자본 = 매물가 - 최대 대출 가능액
- 계약금이 현실적 저축 범위 내인지 확인

---

### [P0] REQ-2.2 매물 상세 조회

**설명**: 매물의 상세 정보 및 구매 시뮬레이션 제공
**관련 테이블**: `properties`, `price_history`

**입력**:

- 매물 ID (property_id)

**출력**:

- 매물 기본 정보 (아파트명, 주소, 면적, 층, 건축연도)
- 최근 실거래가
- 교통 정보 (지하철역, 도보 시간)
- **구매 시뮬레이션**:
  - 계약금 (30%), 중도금 (30%), 잔금 (40%)
  - 대출 가능액, 월 상환액 예상

**제약조건**:

- `data_source`가 '국토부'인 매물 우선 표시

---

### [P1] REQ-2.3 실거래 가격 추이 분석

**설명**: 최근 3개월 ~ 1년 실거래 가격 추이 그래프 표시
**관련 테이블**: `price_history`

**입력**:

- 매물 ID (property_id)
- 조회 기간 (기본값: 최근 3개월)

**출력**:

- 날짜별 실거래가 차트
- 가격 변동률 (`price_change_ratio`)
- 가격 추세 (상승/하락/안정)

**제약조건**:

- 데이터 없을 시 "실거래 이력 부족" 메시지

---

## 3. DSR 계산 시스템

### [P0] REQ-3.1 DSR 계산기

**설명**: 2025년 스트레스 DSR 3단계 규제를 완전 반영한 대출 가능액 계산
**관련 테이블**: `dsr_calculations`, `policy_history`, `users`

**입력**:

- 연소득 (`annual_income`)
- 기존 대출 월 상환액 (`existing_loan_monthly`)
- 신규 대출 희망액 (`loan_amount`)
- 실제 금리 (`interest_rate`)
- 대출 기간 (`loan_period_years`)

**출력**:

- **월 상환액** (`monthly_payment`) - 원리금균등상환 방식
- **총 월 부채 상환액** (`total_monthly_debt`) = 기존 + 신규
- **DSR 비율** (`dsr_ratio`) = (월 상환액 × 12) / 연소득 × 100
- **최대 대출 가능액** (`max_loan_amount`)
- **승인 가능 여부** (`is_approved`) - DSR 40% 이하면 TRUE

**제약조건**:

- **스트레스 금리 자동 적용**:
  - 수도권: +1.5%
  - 비수도권: +0.75%
- `region_preference_metro` 기준 자동 판단
- 계산 이력 저장 (데이터 분석용)

---

### [P1] REQ-3.2 대출 상환 계획 시뮬레이션

**설명**: 원리금균등, 원금균등, 거치기간 등 다양한 상환 방식 비교
**관련 테이블**: 없음 (계산만 수행)

**입력**:

- 대출 금액, 금리, 상환 방식, 거치기간

**출력**:

- 월별 상환 스케줄
- 총 이자 금액

**제약조건**:

- 거치기간 최대 1년

---

## 4. 드림홈 관리

### [P0] REQ-4.1 드림홈 설정

**설명**: 특정 매물을 "드림홈"으로 설정하고 저축 목표 자동 계산
**관련 테이블**: `dream_homes`, `properties`

**입력**:

- 매물 ID (`property_id`)
- 목표 날짜 (`target_date`)

**출력**:

- 필요 계약금 (`target_amount` = 매물가 × 30%)
- 월 저축 목표 (`monthly_goal` = target_amount / 남은 개월 수)
- 예상 달성 가능 여부

**제약조건**:

- `is_current=TRUE`는 1명당 1개만 (UNIQUE 제약)
- 이전 드림홈은 `is_current=NULL`로 변경
- `status` = 'ACTIVE'

---

### [P0] REQ-4.2 드림홈 달성률 조회

**설명**: 현재 저축액 대비 목표 달성률 표시
**관련 테이블**: `dream_homes`, `saving_records`

**입력**:

- 사용자 ID (`user_id`)

**출력**:

- 목표 금액 (`target_amount`)
- 현재 저축액 (saving_records 합계)
- 달성률 (%)
- 예상 달성일 (`estimated_achievement_date`)
- 목표 대비 앞당김/늦어짐 일수 (`days_ahead_or_behind`)

**제약조건**:

- `is_current=TRUE`인 드림홈만 조회

---

### [P1] REQ-4.3 드림홈 변경 이력 관리

**설명**: 드림홈 변경 시 이전 드림홈 보존 및 변경 사유 기록
**관련 테이블**: `dream_homes`

**입력**:

- 새로운 매물 ID
- 변경 사유 (`deactivation_reason`)

**출력**:

- 이전 드림홈 히스토리

**제약조건**:

- `status` 변경: ACTIVE → CHANGED
- `deactivated_at` 기록
- 이전 드림홈은 `is_current=NULL`

---

## 5. 저축 관리

### [P0] REQ-5.1 저축 기록 입력

**설명**: 저축 금액과 저축 방법 기록, 즉시 목표 달성률 및 경험치 업데이트
**관련 테이블**: `saving_records`, `user_levels`

**입력**:

- 저축 금액 (`amount`, 원 단위)
- 저축 방법 (`saving_method`, 예: KB청년희망적금)
- 저축 날짜 (`saved_date`)
- 메모 (선택)

**출력**:

- 기록 성공 메시지
- 업데이트된 달성률
- 레벨/경험치 변동

**제약조건**:

- 금액은 양수만 가능
- 1일 10회 이상 기록 시 이상거래 감지 (FDS)

---

### [P0] REQ-5.2 저축 통계 조회

**설명**: 월별, 주별, 일별 저축 통계 제공
**관련 테이블**: `saving_records`

**입력**:

- 사용자 ID
- 조회 기간 (기본값: 최근 6개월)

**출력**:

- 월별 저축 총액
- 평균 저축액
- 저축 횟수

**제약조건**:

- 없음

---

### [P1] REQ-5.3 저축 기록 수정/삭제

**설명**: 잘못 입력한 저축 기록 수정/삭제
**관련 테이블**: `saving_records`, `user_levels`

**입력**:

- 기록 ID (`record_id`)
- 수정할 내용

**출력**:

- 수정/삭제 성공 메시지

**제약조건**:

- 본인 기록만 수정/삭제 가능
- 삭제 시 레벨/경험치 재계산

---

## 6. 게이미피케이션

### [P0] REQ-6.1 레벨 시스템

**설명**: 저축 활동을 통해 경험치 획득 및 레벨업
**관련 테이블**: `user_levels`

**입력**:

- 저축 기록 (자동)

**출력**:

- 현재 레벨 (`current_level`)
- 경험치 (`experience_points`)
- 레벨 타이틀 (`level_title`, 예: "꾸준한 실천가")
- 다음 레벨까지 필요 경험치

**제약조건**:

- **경험치 획득 규칙**:
  - 저축 1회: +10 EXP
  - 월 목표 달성: +50 EXP
  - 연속 저축 7일: +30 EXP
- **레벨업 기준**:
  - Lv 1: 0 EXP (꿈나무)
  - Lv 2: 100 EXP (새싹)
  - Lv 3: 300 EXP (꾸준한 실천가)
  - Lv 4: 500 EXP (전문가)
  - Lv 5: 1000 EXP (집 숲지기)

---

### [P0] REQ-6.2 집 수집

**설명**: 특정 조건 달성 시 집 획득 (4계절 × 2레벨 = 8종)
**관련 테이블**: `house_trees`, `user_house_trees`

**입력**:

- 달성 조건 확인 (자동)

**출력**:

- 획득한 집 정보
- 집 애니메이션 (WebP)

**제약조건**:

- **집 구조**: 4계절 × 2레벨 = 8종
  - **봄**: 벚꽃지붕 집 (COMMON), 벚꽃정원 집 (RARE)
  - **여름**: 잔디벽 집 (COMMON), 야자수 집 (RARE)
  - **가을**: 단풍 테라스 집 (COMMON), 황금 집 (RARE)
  - **겨울**: 눈굴뚝 집 (COMMON), 크리스탈 집 (RARE)
- **획득 조건 예시**:
  - 첫 저축: 봄 벚꽃지붕 집 (COMMON)
  - 레벨 2 달성: 여름 잔디벽 집 (COMMON)
  - 레벨 3 + 100만원 저축: 가을 단풍 테라스 집 (COMMON)
  - 총 500만원 저축: 봄 벚꽃정원 집 (RARE)
- 동일 집 중복 획득 시 `tree_level` 증가
- `is_displayed_in_forest=TRUE`인 집만 숲에 표시

---

### [P1] REQ-6.3 연속 저축 스트릭

**설명**: 연속으로 저축한 일수 기록 및 배지 제공
**관련 테이블**: `user_levels`

**입력**:

- 저축 날짜 (자동)

**출력**:

- 현재 연속 저축 일수 (`current_streak`)
- 최장 연속 저축 일수 (`longest_streak`)

**제약조건**:

- 1일 이상 저축 없으면 스트릭 초기화

---

### [P1] REQ-6.4 집 숲 관리

**설명**: 획득한 집 배치하여 나만의 숲 꾸미기
**관련 테이블**: `user_house_trees`

**입력**:

- 집 배치 정보

**출력**:

- 집 숲 렌더링 (SVG 애니메이션)

**제약조건**:

- `is_displayed_in_forest=TRUE`인 집만 표시

---

## 7. 정보 제공

### [P2] REQ-7.1 주간 리포트

**설명**: 매주 월요일 오전 9시에 개인화된 리포트 제공
**관련 테이블**: `users`, `dream_homes`, `saving_records`, `price_history`

**입력**:

- 사용자 ID (자동)

**출력**:

- 지난주 저축 현황
- 드림홈 시세 변동
- 금융 정책 변화
- 이번 주 미션

**제약조건**:

- 드림홈 설정 사용자만 발송

---

### [P2] REQ-7.2 특판 상품 안내

**설명**: 은행 청년 적금 등 특판 상품 안내
**관련 테이블**: (추후 설계 필요)

**입력**:

- 특판 상품 정보 (관리자 등록)

**출력**:

- 상품명, 금리, 가입 조건
- 남은 인원

**제약조건**:

- 레벨 제한 가능
- 중복 가입 방지

---

### [P2] REQ-7.3 유사 사용자 분석

**설명**: "이 집을 본 사람들은..." 추천
**관련 테이블**: `users`, `dream_homes`, `properties`

**입력**:

- 현재 매물 정보

**출력**:

- 유사 사용자들이 관심 있는 매물 리스트

**제약조건**:

- 비슷한 연령대(±3년), 비슷한 소득(±20%) 사용자 분석

---

## 📊 우선순위 요약

### P0 (MUST) - MVP 핵심 기능

| 기능 영역          | 요구사항                | 관련 테이블                                          |
| ------------------ | ----------------------- | ---------------------------------------------------- |
| **회원 관리**      | 회원가입/로그인         | users                                                |
| **회원 관리**      | 온보딩 프로세스         | users, preferred_areas                               |
| **매물 조회**      | 구매력 기반 매물 필터링 | properties, users, preferred_areas, dsr_calculations |
| **매물 조회**      | 매물 상세 조회          | properties, price_history                            |
| **DSR 계산**       | DSR 계산기              | dsr_calculations, policy_history, users              |
| **드림홈 관리**    | 드림홈 설정             | dream_homes, properties                              |
| **드림홈 관리**    | 드림홈 달성률 조회      | dream_homes, saving_records                          |
| **저축 관리**      | 저축 기록 입력          | saving_records, user_levels                          |
| **저축 관리**      | 저축 통계 조회          | saving_records                                       |
| **게이미피케이션** | 레벨 시스템             | user_levels                                          |
| **게이미피케이션** | 집 수집                 | house_trees, user_house_trees                        |

**총 11개 핵심 요구사항**

---

### P1 (SHOULD) - 차별화 기능

| 기능 영역          | 요구사항                  | 관련 테이블                 |
| ------------------ | ------------------------- | --------------------------- |
| **회원 관리**      | 프로필 수정               | users, preferred_areas      |
| **회원 관리**      | 소셜 로그인               | users                       |
| **매물 조회**      | 실거래 가격 추이 분석     | price_history               |
| **DSR 계산**       | 대출 상환 계획 시뮬레이션 | 없음                        |
| **드림홈 관리**    | 드림홈 변경 이력 관리     | dream_homes                 |
| **저축 관리**      | 저축 기록 수정/삭제       | saving_records, user_levels |
| **게이미피케이션** | 연속 저축 스트릭          | user_levels                 |
| **게이미피케이션** | 집 숲 관리                | user_house_trees            |

**총 8개 차별화 요구사항**

---

### P2 (COULD) - 향후 확장 기능

| 기능 영역     | 요구사항         | 관련 테이블                                       |
| ------------- | ---------------- | ------------------------------------------------- |
| **정보 제공** | 주간 리포트      | users, dream_homes, saving_records, price_history |
| **정보 제공** | 특판 상품 안내   | 추후 설계                                         |
| **정보 제공** | 유사 사용자 분석 | users, dream_homes, properties                    |

**총 3개 확장 요구사항**

---

## 🔒 비기능 요구사항

### 성능

**NFR-1: 응답 속도**

- API 응답 시간 < 300ms (95 percentile)
- 매물 리스트 조회 < 500ms
- DSR 계산 < 100ms

**NFR-2: 동시 사용자**

- 동시 접속자 1,000명 처리 가능
- TPS (Transaction Per Second) > 500

**NFR-3: 캐싱**

- 자주 조회되는 매물 정보 Redis 캐싱 (TTL: 24시간)
- 정책 정보 캐싱 (TTL: 7일)

---

### 보안

**NFR-4: 인증/인가**

- JWT 기반 인증 (Access Token + Refresh Token)
- HTTPS 필수
- SQL Injection, XSS 방어

**NFR-5: 개인정보 보호**

- 비밀번호 bcrypt 암호화 (salt rounds: 10)
- 민감 정보 (연소득) 암호화 저장
- 로그에 개인정보 미포함

**NFR-6: 이상거래 탐지 (FDS)**

- 7일 내 연소득 3회 이상 변경 감지
- 1일 10회 이상 저축 기록 감지
- 동일 IP 5개 계정 동시 가입 차단

---

### 사용성

**NFR-7: 반응형 디자인**

- 모바일, 태블릿, 데스크탑 지원
- Mobile-First 설계

**NFR-8: 접근성**

- WCAG 2.1 AA 준수
- 키보드 네비게이션 지원
- 적절한 색상 대비

**NFR-9: 브라우저 호환성**

- Chrome, Safari, Edge 최신 버전
- Firefox 최신 버전

---

### 데이터

**NFR-10: 데이터 정확성**

- 국토부 API 데이터 검증
- 금융 정책 정보 수동 검증 후 적용

**NFR-11: 백업**

- 일일 DB 백업
- 30일 보관

---

## 📌 기술 스택

### 프론트엔드

- Vue 3 (Composition API)
- Vue Router 4, Pinia (상태 관리)
- Tailwind CSS
- Chart.js (데이터 시각화)
- Vite (번들러)

### 백엔드

- Spring Boot 3.2+
- Spring Security (JWT)
- Spring MyBatis
- Spring Batch (데이터 파이프라인)

### 데이터베이스

- MySQL 8.0+
- Redis 7 (캐싱)

### 인프라

- Spring Actuator
- Prometheus + Grafana (모니터링)

---

## ✅ 마일스톤

### Phase 1 (MVP - 8주)

- [x] 회원가입/로그인
- [x] 온보딩 (연소득, 희망 지역)
- [x] DSR 계산기
- [x] 매물 조회 (구매력 기반 필터링)
- [x] 드림홈 설정
- [x] 저축 기록
- [x] 레벨 시스템
- [x] 집 수집 (8종)

### Phase 2 (확장 - 4주)

- [ ] 소셜 로그인
- [ ] 실거래 가격 추이 차트
- [ ] 대출 상환 계획 시뮬레이션
- [ ] 드림홈 변경 이력 관리
- [ ] 집 숲 WebP 애니메이션

### Phase 3 (고도화 - 4주)

- [ ] 주간 리포트
- [ ] 특판 상품 연동
- [ ] 유사 사용자 분석
- [ ] PWA 변환

---

**작성일**: 2025-11-07
**버전**: 2.0
**작성자**: SSAFY Team
