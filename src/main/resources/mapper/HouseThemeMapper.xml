<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jipjung.project.repository.HouseThemeMapper">

    <!-- Result Map -->
    <resultMap id="HouseThemeResultMap" type="com.jipjung.project.domain.HouseTheme">
        <id property="themeId" column="theme_id"/>
        <result property="themeCode" column="theme_code"/>
        <result property="themeName" column="theme_name"/>
        <result property="imagePath" column="image_path"/>
        <result property="isActive" column="is_active"/>
        <result property="createdAt" column="created_at"/>
        <result property="updatedAt" column="updated_at"/>
        <result property="isDeleted" column="is_deleted"/>
    </resultMap>

    <!-- 활성 테마 목록 조회 -->
    <select id="findAllActive" resultMap="HouseThemeResultMap">
        SELECT theme_id, theme_code, theme_name, image_path, is_active, created_at, updated_at, is_deleted
        FROM house_theme
        WHERE is_active = TRUE
          AND is_deleted = FALSE
        ORDER BY theme_id
    </select>

    <!-- 테마 ID로 단건 조회 (삭제되지 않은 것만) -->
    <select id="findById" resultMap="HouseThemeResultMap">
        SELECT theme_id, theme_code, theme_name, image_path, is_active, created_at, updated_at, is_deleted
        FROM house_theme
        WHERE theme_id = #{themeId}
          AND is_deleted = FALSE
    </select>

    <!-- 테마 존재 + 활성 여부 확인 -->
    <select id="existsAndActive" resultType="boolean">
        SELECT COUNT(*) > 0
        FROM house_theme
        WHERE theme_id = #{themeId}
          AND is_active = TRUE
          AND is_deleted = FALSE
    </select>

</mapper>
